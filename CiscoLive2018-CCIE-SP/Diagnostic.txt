<h1 id="config_top">Devices Configuration</h1>
<h2>Table of Content</h2>
<ul>
<li><a href="#router1">CE41</a></li>
<li><a href="#router2">CE42</a></li>
<li><a href="#router3">PE12</a></li>
<li><a href="#router4">PE21</a></li>
<li><a href="#router5">RR25</a></li>
<li><a href="#router6">CE43</a></li>
<li><a href="#router7">CE44</a></li>
<li><a href="#router8">CE45</a></li>
<li><a href="#router9">PE11</a></li>
<li><a href="#router10">P13</a></li>
<li><a href="#router11">RR17</a></li>
<li><a href="#router12">PE31</a></li>
<li><a href="#router3">PE23</a></li>
<li><a href="#router4">PE22</a></li>
<li><a href="#router5">RR46</a></li>
<li><a href="#router6">CE24</a></li>
<li><a href="#router7">CE15</a></li>
<li><a href="#router8">CE16</a></li>
<li><a href="#router9">P14</a></li>
</ul>
<h3 has-toc-entry id="router1">CE41 router</h3>
<div class="cli">
hostname CE41
!
boot-start-marker
boot-end-marker
!
!
enable secret 5 $1$eW0a$nfHbLotzOiwDnd3g89q1p1
!
no aaa new-model
!
!
!
!
!
!
!
!
!
no ip domain lookup
!
!
!
ipv6 unicast-routing
!
!
!
!
!
!
!
subscriber templating
!
!
!
!
!
!
!
multilink bundle-name authenticated
!
!
!
!
!
crypto pki trustpoint TP-self-signed-628917449
enrollment selfsigned
subject-name cn=IOS-Self-Signed-Certificate-628917449
revocation-check none
rsakeypair TP-self-signed-628917449
!
!
crypto pki certificate chain TP-self-signed-628917449
certificate self-signed 01 nvram:IOS-Self-Sig#1.cer
!
!
!
!
!
!
!
!
license udi pid CSR1000V sn 9W5ZCW7GDJK
diagnostic bootup level minimal
!
spanning-tree extend system-id
!
!
username cisco privilege 15 secret 5 $1$zAa3$NJMe88qwwHfRJGYsX2XPI/
!
redundancy
!
!
!
!
interface Loopback0
ip address 10.0.0.41 255.255.255.255
!
interface LISP0
!
interface GigabitEthernet1
ip address 10.255.0.114 255.255.0.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet2
ip address 10.2.41.41 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet3
ip address 10.3.41.41 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
!
router lisp
service ipv4
itr map-resolver 10.0.0.44
itr
etr map-server 10.0.0.44 key cisco
etr
exit-service-ipv4
!
instance-id 0
service ipv4
eid-table default
database-mapping 10.2.42.0/24 IPv4-interface GigabitEthernet2 priority 1 weight 10
database-mapping 10.4.42.0/24 IPv4-interface GigabitEthernet2 priority 1 weight 10
exit-service-ipv4
!
service ipv6
eid-table default
exit-service-ipv6
!
exit-instance-id
!
exit-router-lisp
!
router ospf 1
network 0.0.0.0 255.255.255.255 area 0
!
router bgp 4142
bgp router-id interface Loopback0
bgp log-neighbor-changes
neighbor 10.2.41.11 remote-as 100
!
address-family ipv4
network 10.0.0.41 mask 255.255.255.255
neighbor 10.2.41.11 activate
exit-address-family
!
address-family ipv6
neighbor 10.2.41.11 activate
exit-address-family
!
threat-visibility
!
virtual-service csr_mgmt
!
ip forward-protocol nd
no ip http server
ip http authentication local
no ip http secure-server
!
ip ssh server algorithm encryption aes128-ctr aes192-ctr aes256-ctr
ip ssh client algorithm encryption aes128-ctr aes192-ctr aes256-ctr
!
!
!
!
!
control-plane
!
!
!
!
!
!
!
!
!
!
line con 0
privilege level 15
password cisco
logging synchronous
stopbits 1
line vty 0 4
exec-timeout 720 0
password cisco
login local
transport input telnet ssh
transport output telnet ssh
!
!
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router2">CE42 router</h3>
<div class="cli">
hostname CE42
!
boot-start-marker
boot-end-marker
!
!
enable secret 5 $1$7MYw$Y4g/SSJZ8HblGnB91IwV1/
!
no aaa new-model
!
!
!
!
!
!
!
!
!
!
!
!
ipv6 unicast-routing
!
!
!
!
!
!
!
subscriber templating
!
!
!
!
!
!
!
multilink bundle-name authenticated
!
!
!
!
!
crypto pki trustpoint TP-self-signed-2719270573
enrollment selfsigned
subject-name cn=IOS-Self-Signed-Certificate-2719270573
revocation-check none
rsakeypair TP-self-signed-2719270573
!
!
crypto pki certificate chain TP-self-signed-2719270573
certificate self-signed 01 nvram:IOS-Self-Sig#1.cer
!
!
!
!
!
!
!
!
license udi pid CSR1000V sn 9RA4JKHXYH7
diagnostic bootup level minimal
!
spanning-tree extend system-id
!
!
username cisco privilege 15 secret 5 $1$zAa3$NJMe88qwwHfRJGYsX2XPI/
!
redundancy
!
!
!
!
!
!
!
class-map match-all icmp
match protocol icmp
class-map match-any CRM
match ip precedence 4
match ip dscp af41
class-map match-any bfd
match ip dscp cs6
class-map match-all voice
match ip dscp ef
!
policy-map as4142-out
class bfd
bandwidth 100000
class icmp
bandwidth 10000
class voice
bandwidth 20000
class CRM
bandwidth 50000
class class-default
bandwidth 10000
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
interface Loopback0
ip address 10.0.0.42 255.255.255.255
!
interface LISP0
!
interface GigabitEthernet1
ip address 10.255.0.115 255.255.0.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet2
ip address 10.2.42.42 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
bfd interval 1000 min_rx 1000 multiplier 3
no bfd echo
!
interface GigabitEthernet3
ip address 10.3.41.42 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
!
router lisp
service ipv4
itr map-resolver 10.0.0.44
itr
etr map-server 10.0.0.44 key cisco
etr
exit-service-ipv4
!
instance-id 0
service ipv4
eid-table default
database-mapping 10.2.42.0/24 IPv4-interface GigabitEthernet2 priority 1 weight 10
exit-service-ipv4
!
service ipv6
eid-table default
exit-service-ipv6
!
exit-instance-id
!
exit-router-lisp
!
router ospf 1
network 0.0.0.0 255.255.255.255 area 0
!
router bgp 4142
bgp log-neighbor-changes
neighbor 10.2.42.12 remote-as 100
neighbor 10.2.42.12 fall-over bfd
!
address-family ipv4
network 10.0.0.42 mask 255.255.255.255
neighbor 10.2.42.12 activate
exit-address-family
!
address-family ipv6
neighbor 10.2.42.12 activate
exit-address-family
!
threat-visibility
!
virtual-service csr_mgmt
!
ip forward-protocol nd
no ip http server
ip http authentication local
no ip http secure-server
!
ip ssh server algorithm encryption aes128-ctr aes192-ctr aes256-ctr
ip ssh client algorithm encryption aes128-ctr aes192-ctr aes256-ctr
!
!
!
!
!
control-plane
!
!
!
!
!
!
!
!
!
!
line con 0
privilege level 15
password cisco
logging synchronous
stopbits 1
line vty 0 4
exec-timeout 720 0
password cisco
login local
transport input telnet ssh
transport output telnet ssh
!
!
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router3">PE12 router</h3>
<div class="cli">
hostname PE12
!
boot-start-marker
boot-end-marker
!
!
enable secret 5 $1$WDAL$H5nJmXIjm15OTPiysCHuk.
!
no aaa new-model
!
ip vrf cust1
rd 1:1
route-target export 1:100
route-target import 1:100
route-target import 1:45
route-target import 1:43
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
subscriber templating
!
!
!
!
!
mpls traffic-eng tunnels
!
!
multilink bundle-name authenticated
!
!
!
!
!
crypto pki trustpoint TP-self-signed-815937629
enrollment selfsigned
subject-name cn=IOS-Self-Signed-Certificate-815937629
revocation-check none
rsakeypair TP-self-signed-815937629
!
!
crypto pki certificate chain TP-self-signed-815937629
certificate self-signed 01 nvram:IOS-Self-Sig#1.cer
!
!
!
!
!
!
!
!
license udi pid CSR1000V sn 9NC3WCEOCO7
diagnostic bootup level minimal
!
spanning-tree extend system-id
!
!
username cisco privilege 15 secret 5 $1$jbPy$vbn/6njO/0vK.s43bOx071
!
redundancy
!
!
!
!
!
!
!
class-map match-all icmp
match protocol icmp
class-map match-any CRM
match ip precedence 4
match ip dscp af41
class-map match-any bfd
match ip dscp cs7
class-map match-all voice
match ip dscp ef
!
policy-map as4142-out
class bfd
bandwidth 10000
class icmp
bandwidth 1000
class voice
bandwidth 10000
class CRM
bandwidth 50000
class class-default
bandwidth 10000
policy-map as4142-in
class bfd
bandwidth 2000
class voice
bandwidth 5000
class CRM
bandwidth 30000
class class-default
policy-map cust1-in
class class-default
police rate 50000000 bps
service-policy as4142-in
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
interface Loopback0
ip address 10.0.0.12 255.255.255.255
ip router isis AS100
!
interface Loopback1
no ip address
!
interface Loopback3
ip vrf forwarding cust1
ip address 10.3.0.12 255.255.255.255
!
interface GigabitEthernet1
ip address 10.255.0.123 255.255.0.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet2
no ip address
shutdown
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet3
ip address 10.1.9.12 255.255.255.0
ip router isis AS100
negotiation auto
mpls traffic-eng tunnels
no mop enabled
no mop sysid
isis network point-to-point
ip rsvp bandwidth 1000000
!
interface GigabitEthernet4
ip address 10.1.10.12 255.255.255.0
ip router isis AS100
negotiation auto
mpls traffic-eng tunnels
no mop enabled
no mop sysid
isis network point-to-point
ip rsvp bandwidth 1000000
!
interface GigabitEthernet5
ip address 10.1.5.12 255.255.255.0
ip router isis AS100
negotiation auto
mpls traffic-eng tunnels
no mop enabled
no mop sysid
isis network point-to-point
ip rsvp bandwidth 1000000
!
interface GigabitEthernet6
ip vrf forwarding cust1
ip address 10.2.42.12 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
bfd interval 1000 min_rx 1000 multiplier 3
no bfd echo
!
interface GigabitEthernet7
no ip address
shutdown
negotiation auto
no mop enabled
no mop sysid
!
router ospf 2 vrf cust1
router-id 0.0.0.12
domain-id type 0005 value 000000640200
domain-tag 4142
area 0 sham-link 10.3.0.12 10.3.0.11
network 10.2.42.0 0.0.0.255 area 0
!
router isis AS100
net 10.0000.0000.0012.00
is-type level-2-only
router-id Loopback0
metric-style wide
mpls traffic-eng router-id Loopback0
mpls traffic-eng level-2
mpls ldp autoconfig
!
router bgp 100
bgp router-id 10.0.0.12
bgp log-neighbor-changes
no bgp default ipv4-unicast
neighbor 10.0.0.17 remote-as 100
neighbor 10.0.0.17 update-source Loopback0
!
address-family vpnv4
bgp additional-paths select backup
bgp additional-paths install
neighbor 10.0.0.17 activate
neighbor 10.0.0.17 send-community extended
neighbor 10.0.0.17 route-reflector-client
exit-address-family
!
address-family ipv4 vrf cust1
redistribute connected
neighbor 10.2.42.42 remote-as 4142
neighbor 10.2.42.42 fall-over bfd
neighbor 10.2.42.42 activate
exit-address-family
!
threat-visibility
!
virtual-service csr_mgmt
!
ip forward-protocol nd
no ip http server
ip http authentication local
no ip http secure-server
!
ip ssh server algorithm encryption aes128-ctr aes192-ctr aes256-ctr
ip ssh client algorithm encryption aes128-ctr aes192-ctr aes256-ctr
!
!
!
!
!
control-plane
!
!
!
!
!
!
!
!
!
!
line con 0
privilege level 15
password cisco
logging synchronous
stopbits 1
line vty 0 4
exec-timeout 720 0
password cisco
login local
transport input telnet ssh
!
!
!
!
!
event manager session cli username "cisco" privilege 15
event manager applet TEST1
event syslog pattern "LDP" maxrun 2000
action 1.3 cli command "telnet 10.0.0.11" pattern "Username: "
action 1.4 cli command "cisco" pattern "Password: "
action 1.6 cli command "cisco" pattern "#"
action 1.7 cli command "admin" pattern "#"
action 1.8 cli command "process shut tcp loc all" pattern "confirm"
action 1.9 cli command "y" pattern "#"
event manager applet TEST2
event none maxrun 2000
action 1.3 cli command "telnet 10.0.0.11" pattern "Username: "
action 1.4 cli command "cisco" pattern "Password: "
action 1.6 cli command "cisco" pattern "#"
action 1.7 cli command "admin" pattern "#"
action 1.8 cli command "process shut tcp loc all" pattern "confirm"
action 1.9 cli command "y" pattern "#"
action 2.0 cli command "exit" pattern "#"
action 2.1 cli command "exit"
action 2.2 cli command "conf t"
action 2.3 cli command "no event manager applet TEST1"
action 2.4 cli command "no event manager session cli username cisco privilege 15"
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router4">PE21 router</h3>
<div class="cli">
hostname PE21
!
boot-start-marker
boot-end-marker
!
!
enable secret 5 $1$j9cV$OHJSboZ/eH5PMeZzzlMeP/
!
no aaa new-model
!
!
!
!
!
!
!
!
!
no ip domain lookup
ip multicast-routing distributed
!
!
!
ip igmp ssm-map enable
ip igmp ssm-map static mcast-233 10.1.0.31
ipv6 unicast-routing
!
!
!
!
!
!
!
subscriber templating
!
!
!
!
!
!
!
multilink bundle-name authenticated
!
!
!
!
!
crypto pki trustpoint TP-self-signed-1920988022
enrollment selfsigned
subject-name cn=IOS-Self-Signed-Certificate-1920988022
revocation-check none
rsakeypair TP-self-signed-1920988022
!
!
crypto pki certificate chain TP-self-signed-1920988022
certificate self-signed 01 nvram:IOS-Self-Sig#1.cer
!
!
!
!
!
!
!
!
license udi pid CSR1000V sn 9YE712QGRK4
diagnostic bootup level minimal
!
spanning-tree extend system-id
!
!
username cisco privilege 15 secret 5 $1$zAa3$NJMe88qwwHfRJGYsX2XPI/
!
redundancy
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
interface Loopback0
ip address 10.0.0.21 255.255.255.0
ip pim sparse-mode
ip igmp join-group 233.3.3.3 source 10.1.0.31
ip igmp join-group 233.2.2.2 source 10.1.0.31
!
interface GigabitEthernet1
ip address 10.255.0.126 255.255.0.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet2
ip address 192.168.1.21 255.255.255.0
ip pim sparse-mode
ip igmp join-group 233.2.2.2
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet3
ip address 172.16.1.21 255.255.255.0
negotiation auto
mpls bgp forwarding
no mop enabled
no mop sysid
!
interface GigabitEthernet4
ip address 192.168.2.21 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet5
ip address 172.16.2.21 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
!
router ospf 1
network 10.0.0.0 0.0.0.255 area 0
network 192.168.1.0 0.0.0.255 area 1
network 192.168.0.0 0.0.255.255 area 0
mpls ldp autoconfig area 0
!
router bgp 200
bgp router-id 10.0.0.21
bgp log-neighbor-changes
no bgp default ipv4-unicast
neighbor 10.0.0.25 remote-as 200
neighbor 10.0.0.25 update-source Loopback0
neighbor 172.16.1.15 remote-as 100
!
address-family vpnv4
neighbor 10.0.0.25 activate
neighbor 10.0.0.25 send-community extended
neighbor 10.0.0.25 route-reflector-client
neighbor 10.0.0.25 next-hop-self
neighbor 172.16.1.15 activate
neighbor 172.16.1.15 send-community extended
neighbor 172.16.1.15 next-hop-self
exit-address-family
!
threat-visibility
!
virtual-service csr_mgmt
!
ip forward-protocol nd
no ip http server
ip http authentication local
no ip http secure-server
ip pim rp-address 10.1.0.31
ip pim ssm range mcast-233
!
ip ssh server algorithm encryption aes128-ctr aes192-ctr aes256-ctr
ip ssh client algorithm encryption aes128-ctr aes192-ctr aes256-ctr
!
ip access-list standard mcast-233
permit 233.0.0.0 0.255.255.255
!
!
!
!
!
control-plane
!
!
!
!
!
!
!
!
!
!
line con 0
privilege level 15
password cisco
logging synchronous
stopbits 1
line vty 0 4
exec-timeout 720 0
password cisco
login local
transport input telnet ssh
transport output telnet ssh
!
!
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router5">RR25 router</h3>
<div class="cli">
hostname RR25
!
boot-start-marker
boot-end-marker
!
!
enable secret 5 $1$nllv$hUuwoqksbpgz6ECpr.cVR1
!
no aaa new-model
!
!
!
!
!
!
!
!
!
!
!
!
ipv6 unicast-routing
!
!
!
!
!
!
!
subscriber templating
!
!
!
!
!
!
!
multilink bundle-name authenticated
!
!
!
!
!
crypto pki trustpoint TP-self-signed-3360417384
enrollment selfsigned
subject-name cn=IOS-Self-Signed-Certificate-3360417384
revocation-check none
rsakeypair TP-self-signed-3360417384
!
!
crypto pki certificate chain TP-self-signed-3360417384
certificate self-signed 01 nvram:IOS-Self-Sig#1.cer
!
!
!
!
!
!
!
!
license udi pid CSR1000V sn 9GZZQ2WDHXC
diagnostic bootup level minimal
!
spanning-tree extend system-id
!
!
username cisco privilege 15 secret 5 $1$zAa3$NJMe88qwwHfRJGYsX2XPI/
!
redundancy
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
interface Loopback0
ip address 10.0.0.25 255.255.255.255
!
interface GigabitEthernet1
ip address 10.255.0.132 255.255.0.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet2
ip address 192.168.6.25 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
!
router ospf 1
network 10.0.0.0 0.0.0.255 area 0
network 192.168.0.0 0.0.255.255 area 0
mpls ldp autoconfig area 0
!
router bgp 200
bgp router-id 10.0.0.25
bgp log-neighbor-changes
no bgp default ipv4-unicast
neighbor 10.0.0.21 remote-as 200
neighbor 10.0.0.21 update-source Loopback0
neighbor 10.0.0.22 remote-as 200
neighbor 10.0.0.22 update-source Loopback0
neighbor 10.0.0.23 remote-as 200
neighbor 10.0.0.23 update-source Loopback0
neighbor 10.0.0.24 remote-as 200
neighbor 10.0.0.24 update-source Loopback0
!
address-family ipv4
neighbor 10.0.0.22 activate
neighbor 10.0.0.22 route-reflector-client
neighbor 10.0.0.22 send-label
neighbor 10.0.0.24 activate
neighbor 10.0.0.24 route-reflector-client
neighbor 10.0.0.24 send-label
exit-address-family
!
address-family vpnv4
neighbor 10.0.0.21 activate
neighbor 10.0.0.21 send-community extended
neighbor 10.0.0.21 route-reflector-client
neighbor 10.0.0.22 activate
neighbor 10.0.0.22 send-community extended
neighbor 10.0.0.22 route-reflector-client
neighbor 10.0.0.23 activate
neighbor 10.0.0.23 send-community extended
neighbor 10.0.0.23 route-reflector-client
neighbor 10.0.0.24 activate
neighbor 10.0.0.24 send-community extended
neighbor 10.0.0.24 route-reflector-client
exit-address-family
!
threat-visibility
!
virtual-service csr_mgmt
!
ip forward-protocol nd
no ip http server
ip http authentication local
no ip http secure-server
!
ip ssh server algorithm encryption aes128-ctr aes192-ctr aes256-ctr
ip ssh client algorithm encryption aes128-ctr aes192-ctr aes256-ctr
!
!
!
!
!
control-plane
!
!
!
!
!
!
!
!
!
!
line con 0
privilege level 15
password cisco
logging synchronous
stopbits 1
line vty 0 4
exec-timeout 720 0
password cisco
login local
transport input telnet ssh
transport output telnet ssh
!
!
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router6">CE43 router</h3>
<div class="cli">
hostname CE43
!
boot-start-marker
boot-end-marker
!
!
enable secret 5 $1$HVs2$6mTM8qsmd4oJVAl8xHk78/
!
no aaa new-model
!
!
!
!
!
!
!
!
!
!
!
!
ipv6 unicast-routing
!
!
!
!
!
!
!
subscriber templating
!
!
!
!
!
!
!
multilink bundle-name authenticated
!
!
!
!
!
crypto pki trustpoint TP-self-signed-3456821616
enrollment selfsigned
subject-name cn=IOS-Self-Signed-Certificate-3456821616
revocation-check none
rsakeypair TP-self-signed-3456821616
!
!
crypto pki certificate chain TP-self-signed-3456821616
certificate self-signed 01 nvram:IOS-Self-Sig#1.cer
!
!
!
!
!
!
!
!
license udi pid CSR1000V sn 95FPPFGF6VJ
diagnostic bootup level minimal
!
spanning-tree extend system-id
!
!
username cisco privilege 15 secret 5 $1$zAa3$NJMe88qwwHfRJGYsX2XPI/
!
redundancy
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
interface Loopback0
ip address 10.0.0.43 255.255.255.255
!
interface GigabitEthernet1
ip address 10.255.0.116 255.255.0.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet2
ip address 10.2.43.43 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet3
ip address 10.3.43.43 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
!
router bgp 43
bgp log-neighbor-changes
neighbor 10.2.43.11 remote-as 100
neighbor 10.3.43.15 remote-as 100
!
address-family ipv4
network 10.0.0.43 mask 255.255.255.255
neighbor 10.2.43.11 activate
neighbor 10.3.43.15 activate
exit-address-family
!
address-family ipv6
neighbor 10.2.43.11 activate
neighbor 10.3.43.15 activate
exit-address-family
!
threat-visibility
!
virtual-service csr_mgmt
!
ip forward-protocol nd
no ip http server
ip http authentication local
no ip http secure-server
!
ip ssh server algorithm encryption aes128-ctr aes192-ctr aes256-ctr
ip ssh client algorithm encryption aes128-ctr aes192-ctr aes256-ctr
!
!
!
!
!
control-plane
!
!
!
!
!
!
!
!
!
!
line con 0
privilege level 15
password cisco
logging synchronous
stopbits 1
line vty 0 4
exec-timeout 720 0
password cisco
login local
transport input telnet ssh
transport output telnet ssh
!
!
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router7">CE44 router</h3>
<div class="cli">
hostname CE44
!
boot-start-marker
boot-end-marker
!
!
enable secret 5 $1$1zzL$.mA1esnHjDsZZEYGWN/od.
!
no aaa new-model
!
!
!
!
!
!
!
!
!
!
!
!
ipv6 unicast-routing
!
!
!
!
!
!
!
subscriber templating
!
!
!
!
!
!
!
multilink bundle-name authenticated
!
!
!
!
!
crypto pki trustpoint TP-self-signed-3875908460
enrollment selfsigned
subject-name cn=IOS-Self-Signed-Certificate-3875908460
revocation-check none
rsakeypair TP-self-signed-3875908460
!
!
crypto pki certificate chain TP-self-signed-3875908460
certificate self-signed 01 nvram:IOS-Self-Sig#1.cer
!
!
!
!
!
!
!
!
license udi pid CSR1000V sn 9RVD7HM8VTU
diagnostic bootup level minimal
!
spanning-tree extend system-id
!
!
username cisco privilege 15 secret 5 $1$zAa3$NJMe88qwwHfRJGYsX2XPI/
!
redundancy
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
interface Loopback0
ip address 10.0.0.44 255.255.255.255
!
interface GigabitEthernet1
ip address 10.255.0.117 255.255.0.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet2
ip address 10.2.44.44 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet2.10
encapsulation dot1Q 10
ip address 10.4.4.44 255.255.255.0
!
interface GigabitEthernet3
no ip address
negotiation auto
no mop enabled
no mop sysid
!
router lisp
site AS4142
authentication-key cisco
eid-prefix 10.2.41.0/24
eid-prefix 10.2.42.0/24
eid-prefix 10.3.41.0/24
eid-prefix 10.4.42.0/24
allowed-locator 10.2.41.41
allowed-locator 10.2.42.42
exit
!
ipv4 map-server
ipv4 map-resolver
exit
!
router bgp 44
bgp log-neighbor-changes
neighbor 10.2.44.15 remote-as 100
!
address-family ipv4
network 10.0.0.44 mask 255.255.255.255
neighbor 10.2.44.15 activate
exit-address-family
!
address-family ipv6
neighbor 10.2.44.15 activate
exit-address-family
!
threat-visibility
!
virtual-service csr_mgmt
!
ip forward-protocol nd
no ip http server
ip http authentication local
no ip http secure-server
!
ip ssh server algorithm encryption aes128-ctr aes192-ctr aes256-ctr
ip ssh client algorithm encryption aes128-ctr aes192-ctr aes256-ctr
!
!
!
!
!
control-plane
!
!
!
!
!
!
!
!
!
!
line con 0
privilege level 15
password cisco
logging synchronous
stopbits 1
line vty 0 4
exec-timeout 720 0
password cisco
login local
transport input telnet ssh
transport output telnet ssh
!
!
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router8">CE45 router</h3>
<div class="cli">
hostname CE45
!
boot-start-marker
boot-end-marker
!
!
enable secret 5 $1$5hBc$CFq/egykjz06aVYWfUw0C/
!
no aaa new-model
!
!
!
!
!
!
!
!
!
no ip domain lookup
ip multicast-routing distributed
!
!
!
ip igmp ssm-map enable
ip igmp ssm-map static mcast-233 10.1.0.31
ipv6 unicast-routing
!
!
!
!
!
!
!
subscriber templating
!
!
!
!
!
!
!
multilink bundle-name authenticated
!
!
!
!
!
crypto pki trustpoint TP-self-signed-2002296800
enrollment selfsigned
subject-name cn=IOS-Self-Signed-Certificate-2002296800
revocation-check none
rsakeypair TP-self-signed-2002296800
!
!
crypto pki certificate chain TP-self-signed-2002296800
certificate self-signed 01 nvram:IOS-Self-Sig#1.cer
!
!
!
!
!
!
!
!
license udi pid CSR1000V sn 9OMO7NYMJ3W
diagnostic bootup level minimal
!
spanning-tree extend system-id
!
!
username cisco privilege 15 secret 5 $1$zAa3$NJMe88qwwHfRJGYsX2XPI/
!
redundancy
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
interface Loopback0
ip address 10.0.0.45 255.255.255.255
ip pim sparse-mode
ip igmp join-group 233.2.2.2 source 10.3.0.22
!
interface GigabitEthernet1
ip address 10.255.0.118 255.255.0.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet2
ip address 192.168.7.45 255.255.255.0
ip pim sparse-mode
negotiation auto
ipv6 address 2001:0:45::45/64
no mop enabled
no mop sysid
!
router bgp 45
bgp log-neighbor-changes
neighbor 192.168.7.23 remote-as 200
!
address-family ipv4
network 10.0.0.45 mask 255.255.255.255
neighbor 192.168.7.23 activate
exit-address-family
!
address-family ipv6
neighbor 192.168.7.23 activate
exit-address-family
!
threat-visibility
!
virtual-service csr_mgmt
!
ip forward-protocol nd
no ip http server
ip http authentication local
no ip http secure-server
ip pim ssm range mcast-233
!
ip ssh server algorithm encryption aes128-ctr aes192-ctr aes256-ctr
ip ssh client algorithm encryption aes128-ctr aes192-ctr aes256-ctr
!
ip access-list standard mcast-233
permit 233.0.0.0 0.255.255.255
!
!
!
!
!
control-plane
!
!
!
!
!
!
!
!
!
!
line con 0
privilege level 15
password cisco
logging synchronous
stopbits 1
line vty 0 4
exec-timeout 720 0
password cisco
login local
transport input telnet ssh
transport output telnet ssh
!
!
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router9">PE11 router</h3>
<div class="cli">
hostname PE11
telnet vrf default ipv4 server max-servers 10
telnet vrf Mgmt-intf ipv4 server max-servers 10
explicit-path name divert2
index 10 next-address strict ipv4 unicast 10.0.0.13
index 15 next-address strict ipv4 unicast 10.1.5.12
index 20 next-address loose ipv4 unicast 10.0.0.14
index 30 next-address strict ipv4 unicast 10.1.3.13
index 40 next-address strict ipv4 unicast 10.0.0.15
!
explicit-path name divert111
index 5 next-address strict ipv4 unicast 10.0.0.13
index 10 next-address strict ipv4 unicast 10.0.0.12
index 20 next-address strict ipv4 unicast 10.0.0.14
index 40 next-address loose ipv4 unicast 10.0.0.15
!
vrf cust1
address-family ipv4 unicast
import route-target
1:44
1:100
!
export route-target
1:100
!
!
!
vrf cust43
address-family ipv4 unicast
import route-target
1:43
!
export route-target
1:43
!
!
!
interface Loopback0
description Loopback
ipv4 address 10.0.0.11 255.255.255.255
ipv6 address 2001:10::11/128
!
interface Loopback3
vrf cust1
ipv4 address 10.3.0.11 255.255.255.255
!
interface tunnel-te111
ipv4 unnumbered Loopback0
signalled-bandwidth 10000
autoroute announce
metric 1
!
destination 10.1.6.15
path-option 5 explicit name divert2
path-option 10 dynamic
!
interface MgmtEth0/0/CPU0/0
shutdown
!
interface GigabitEthernet0/0/0/0
description to CE43
vrf cust43
ipv4 address 10.2.43.11 255.255.255.0
ipv6 address 2001:10:2:13::11/64
!
interface GigabitEthernet0/0/0/1
description to P13
ipv4 address 10.1.1.11 255.255.255.0
ipv6 address 2001:1:1::11/64
!
interface GigabitEthernet0/0/0/2
description to P14
ipv4 address 10.1.2.11 255.255.255.0
ipv6 address 2001:1:2::11/64
!
interface GigabitEthernet0/0/0/3
shutdown
!
interface GigabitEthernet0/0/0/4
description to CE41
vrf cust1
ipv4 address 10.2.41.11 255.255.255.0
ipv6 address 1001::11/64
!
prefix-set sham-filter
10.3.0.11/32,
10.3.0.12/32
end-set
!
route-policy pass-all
pass
end-policy
!
route-policy sham-filter
if destination in sham-filter then
drop
else
pass
endif
end-policy
!
router static
address-family ipv4 unicast
10.0.0.15/32 tunnel-te111
!
!
router isis AS100
is-type level-2-only
net 10.0000.0000.0011.00
address-family ipv4 unicast
metric-style wide
mpls traffic-eng level-2-only
mpls traffic-eng router-id Loopback0
mpls ldp auto-config
!
address-family ipv6 unicast
metric-style wide
!
interface Loopback0
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
interface GigabitEthernet0/0/0/0
point-to-point
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
interface GigabitEthernet0/0/0/1
point-to-point
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
interface GigabitEthernet0/0/0/2
point-to-point
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
interface GigabitEthernet0/0/0/4
point-to-point
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
!
router ospf 2
router-id 0.0.0.11
vrf cust1
domain-id type 0005 value 000000650200
domain-tag 4241
mtu-ignore enable
area 0
sham-link 10.3.0.11 10.3.0.12
!
interface GigabitEthernet0/0/0/4
!
!
!
!
router bgp 100
bgp router-id 10.0.0.11
address-family ipv4 unicast
!
address-family vpnv4 unicast
!
address-family vpnv6 unicast
!
neighbor 10.0.0.17
remote-as 100
update-source Loopback0
address-family ipv4 unicast
!
address-family vpnv4 unicast
!
!
vrf cust1
rd 1:1
address-family ipv4 unicast
redistribute connected
!
address-family ipv6 unicast
!
neighbor 10.2.41.41
remote-as 4142
address-family ipv4 unicast
route-policy pass-all in
route-policy pass-all out
!
address-family ipv6 unicast
route-policy pass-all in
route-policy pass-all out
!
!
!
vrf cust43
rd 1:43
address-family ipv4 unicast
!
neighbor 10.2.43.43
remote-as 43
address-family ipv4 unicast
route-policy pass-all in
route-policy pass-all out
!
!
!
!
rsvp
interface GigabitEthernet0/0/0/1
bandwidth 1000000
!
interface GigabitEthernet0/0/0/2
bandwidth 1000000
!
!
mpls traffic-eng
interface GigabitEthernet0/0/0/1
!
interface GigabitEthernet0/0/0/2
!
signalling advertise explicit-null
!
mpls ldp
igp sync delay on-session-up 10
address-family ipv4
label
local
allocate for host-routes
advertise
explicit-null
!
!
!
!
!
ssh server v2
ssh server vrf Mgmt-intf
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router10">P13 router</h3>
<div class="cli">
hostname P13
telnet vrf default ipv4 server max-servers 10
telnet vrf Mgmt-intf ipv4 server max-servers 10
interface Loopback0
description Loopback
ipv4 address 10.0.0.13 255.255.255.255
ipv6 address 2001:10::13/128
!
interface MgmtEth0/0/CPU0/0
shutdown
!
interface GigabitEthernet0/0/0/0
description to P14
ipv4 address 10.1.3.13 255.255.255.0
ipv6 address 2001:10:1:3::13/64
!
interface GigabitEthernet0/0/0/1
description to PE11
ipv4 address 10.1.1.13 255.255.255.0
ipv6 address 2001:1:1::13/64
!
interface GigabitEthernet0/0/0/2
description to ASBR16
ipv4 address 10.1.4.13 255.255.255.0
ipv6 address 2001:1:4::13/64
!
interface GigabitEthernet0/0/0/3
description to PE12
ipv4 address 10.1.5.13 255.255.255.0
ipv6 address 2001:1:5::13/64
!
interface GigabitEthernet0/0/0/4
description to PE15
ipv4 address 10.1.6.13 255.255.255.0
ipv6 address 2001:1:4::13/64
!
router isis AS100
is-type level-2-only
net 10.0000.0000.0013.00
address-family ipv4 unicast
metric-style wide
mpls traffic-eng level-2-only
mpls traffic-eng router-id Loopback0
mpls ldp auto-config
!
address-family ipv6 unicast
metric-style wide
!
interface Loopback0
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
interface GigabitEthernet0/0/0/0
point-to-point
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
interface GigabitEthernet0/0/0/1
point-to-point
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
interface GigabitEthernet0/0/0/2
point-to-point
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
interface GigabitEthernet0/0/0/3
point-to-point
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
interface GigabitEthernet0/0/0/4
point-to-point
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
!
router bgp 100
bgp router-id 10.0.0.13
address-family ipv4 unicast
!
address-family vpnv4 unicast
!
neighbor 10.0.0.17
remote-as 100
update-source Loopback0
address-family ipv4 unicast
!
address-family vpnv4 unicast
!
!
!
rsvp
interface GigabitEthernet0/0/0/0
bandwidth 1000000
!
interface GigabitEthernet0/0/0/1
bandwidth 1000000
!
interface GigabitEthernet0/0/0/2
bandwidth 1000000
!
interface GigabitEthernet0/0/0/3
bandwidth 1000000
!
interface GigabitEthernet0/0/0/4
bandwidth 1000000
!
!
mpls traffic-eng
interface GigabitEthernet0/0/0/0
!
interface GigabitEthernet0/0/0/1
!
interface GigabitEthernet0/0/0/2
!
interface GigabitEthernet0/0/0/3
!
interface GigabitEthernet0/0/0/4
!
signalling advertise explicit-null
!
mpls ldp
igp sync delay on-session-up 10
address-family ipv4
label
local
allocate for host-routes
advertise
explicit-null
!
!
!
!
!
ssh server v2
ssh server vrf Mgmt-intf
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router11">RR17 router</h3>
<div class="cli">
hostname RR17
interface Loopback0
ipv4 address 10.0.0.17 255.255.255.255
!
interface MgmtEth0/0/CPU0/0
shutdown
!
interface GigabitEthernet0/0/0/0
ipv4 address 10.1.10.17 255.255.255.0
!
interface GigabitEthernet0/0/0/1
ipv4 address 10.1.11.17 255.255.255.0
!
route-policy pass-all
pass
end-policy
!
router isis AS100
is-type level-2-only
net 10.0000.0000.0017.00
address-family ipv4 unicast
metric-style wide
mpls ldp auto-config
!
address-family ipv6 unicast
metric-style wide
!
interface Loopback0
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
interface GigabitEthernet0/0/0/0
point-to-point
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
interface GigabitEthernet0/0/0/1
point-to-point
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
!
router bgp 100
bgp router-id 10.0.0.17
address-family ipv4 unicast
!
address-family vpnv4 unicast
retain route-target all
!
address-family vpnv6 unicast
!
neighbor 10.0.0.11
remote-as 100
update-source Loopback0
address-family vpnv4 unicast
route-reflector-client
!
!
neighbor 10.0.0.12
remote-as 100
update-source Loopback0
address-family vpnv4 unicast
route-reflector-client
!
!
neighbor 10.0.0.15
remote-as 100
update-source Loopback0
address-family ipv4 labeled-unicast
route-reflector-client
!
address-family vpnv4 unicast
route-reflector-client
!
!
neighbor 10.0.0.16
remote-as 100
update-source Loopback0
address-family ipv4 labeled-unicast
route-reflector-client
!
address-family vpnv4 unicast
route-reflector-client
!
!
!
mpls ldp
igp sync delay on-session-up 10
address-family ipv4
label
local
allocate for host-routes
advertise
explicit-null
!
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router12">PE31 router</h3>
<div class="cli">
hostname PE31
ipv4 access-list ssm1
10 permit ipv4 host 233.0.0.0 any
!
ipv4 access-list as100-in
10 deny tcp any any eq bgp
20 permit ipv4 any any
!
interface Loopback0
ipv4 address 10.0.0.31 255.255.255.255
!
interface Loopback1
ipv4 address 10.1.0.31 255.255.255.255
!
interface MgmtEth0/0/CPU0/0
shutdown
!
interface GigabitEthernet0/0/0/0
ipv4 address 172.16.4.31 255.255.255.0
ipv4 access-group as100-in ingress
!
interface GigabitEthernet0/0/0/1
ipv4 address 172.16.5.31 255.255.255.0
!
route-policy pass-all
pass
end-policy
!
router static
address-family ipv4 unicast
172.16.3.0/24 172.16.5.22
!
!
router bgp 300
address-family ipv4 unicast
network 10.0.0.31/32
network 10.1.0.31/32
redistribute connected
allocate-label all
!
neighbor 172.16.3.16
remote-as 100
ebgp-multihop 3
address-family ipv4 labeled-unicast
route-policy pass-all in
route-policy pass-all out
!
!
neighbor 172.16.4.16
remote-as 100
address-family ipv4 labeled-unicast
route-policy pass-all in
route-policy pass-all out
!
!
neighbor 172.16.5.22
remote-as 200
address-family ipv4 labeled-unicast
route-policy pass-all in
route-policy pass-all out
!
!
!
multicast-routing
address-family ipv4
interface Loopback1
enable
!
interface GigabitEthernet0/0/0/1
enable
!
!
!
router pim
address-family ipv4
rp-address 10.1.0.31
ssm range ssm1
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router13">PE23 router</h3>
<div class="cli">
hostname PE23
vrf cust45
address-family ipv4 unicast
import route-target
1:45
1:46
1:100
!
export route-target
1:45
!
!
!
ipv4 access-list ssm1
10 permit ipv4 host 233.0.0.0 any
!
interface Loopback0
ipv4 address 10.0.0.23 255.255.255.0 route-tag 23
!
interface Loopback1
ipv4 address 10.1.0.23 255.255.255.255
!
interface MgmtEth0/0/CPU0/0
shutdown
!
interface GigabitEthernet0/0/0/0
ipv4 address 192.168.1.23 255.255.255.0
!
interface GigabitEthernet0/0/0/1
ipv4 address 192.168.4.23 255.255.255.0
shutdown
!
interface GigabitEthernet0/0/0/2
ipv4 address 192.168.3.23 255.255.255.0
!
interface GigabitEthernet0/0/0/3
vrf cust45
ipv4 address 192.168.7.23 255.255.255.0
ipv6 address 45::45/64
!
route-policy mldp1
set core-tree mldp-default
end-policy
!
route-policy pass-all
pass
end-policy
!
router ospf 1
mpls ldp sync
mpls ldp auto-config
summary-prefix 10.0.0.0/24
redistribute connected tag 23
address-family ipv4 unicast
area 0
interface Loopback1
!
interface GigabitEthernet0/0/0/1
!
interface GigabitEthernet0/0/0/2
!
!
area 1
interface GigabitEthernet0/0/0/0
!
!
!
router bgp 200
bgp router-id 10.0.0.23
address-family ipv4 unicast
!
address-family vpnv4 unicast
!
address-family vpnv6 unicast
!
neighbor 10.0.0.25
remote-as 200
update-source Loopback0
address-family ipv4 unicast
!
address-family vpnv4 unicast
!
!
vrf cust45
rd 1:45
address-family ipv4 unicast
!
address-family ipv6 unicast
!
neighbor 192.168.7.45
remote-as 45
address-family ipv4 unicast
route-policy pass-all in
route-policy pass-all out
!
address-family ipv6 unicast
route-policy pass-all in
route-policy pass-all out
!
!
!
!
mpls ldp
igp sync delay on-session-up 10
mldp
logging notifications
address-family ipv4
!
!
address-family ipv4
label
local
allocate for host-routes
advertise
explicit-null
!
!
!
!
!
multicast-routing
address-family ipv4
interface Loopback0
enable
!
interface Loopback1
enable
!
interface GigabitEthernet0/0/0/0
enable
!
nsf
mdt source Loopback0
accounting per-prefix
mdt mldp in-band-signaling ipv4
!
vrf cust45
address-family ipv4
mdt source Loopback0
interface all enable
mdt mldp in-band-signaling ipv4
!
!
!
router igmp
interface Loopback1
join-group 233.1.1.1
!
!
router pim
address-family ipv4
rpf topology route-policy mldp1
rp-address 10.1.0.31
interface GigabitEthernet0/0/0/0
enable
!
ssm range ssm1
!
vrf cust45
address-family ipv4
rpf topology route-policy mldp1
interface GigabitEthernet0/0/0/3
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router14">PE22 router</h3>
<div class="cli">
hostname PE22
vrf cust45
address-family ipv4 unicast
import route-target
1:45
1:100
!
export route-target
1:45
!
!
!
ipv4 access-list ssm1
10 permit ipv4 host 233.0.0.0 any
!
interface Loopback0
ipv4 address 10.0.0.22 255.255.255.255
!
interface Loopback1
ipv4 address 10.1.0.22 255.255.255.255
!
interface Loopback2
vrf cust45
ipv4 address 10.3.0.22 255.255.255.255
!
interface MgmtEth0/0/CPU0/0
shutdown
!
interface GigabitEthernet0/0/0/0
ipv4 address 172.16.3.22 255.255.255.0
!
interface GigabitEthernet0/0/0/1
ipv4 address 192.168.5.22 255.255.255.0
!
interface GigabitEthernet0/0/0/2
ipv4 address 172.16.5.22 255.255.255.0
!
interface GigabitEthernet0/0/0/3
ipv4 address 192.168.3.22 255.255.255.0
!
route-policy mldp1
set core-tree mldp-default
end-policy
!
route-policy pass-all
pass
end-policy
!
router static
address-family ipv4 unicast
172.16.5.31/32 GigabitEthernet0/0/0/2
!
!
router ospf 1
mpls ldp sync
mpls ldp auto-config
redistribute bgp 200
address-family ipv4 unicast
area 0
interface Loopback0
!
interface Loopback1
!
interface GigabitEthernet0/0/0/1
!
interface GigabitEthernet0/0/0/3
!
!
!
router bgp 200
bgp router-id 10.0.0.22
address-family ipv4 unicast
network 10.1.0.22/32
allocate-label all
!
address-family vpnv4 unicast
!
address-family vpnv6 unicast
!
neighbor 10.0.0.25
remote-as 200
update-source Loopback0
address-family ipv4 labeled-unicast
next-hop-self
!
address-family vpnv4 unicast
!
!
neighbor 172.16.3.16
remote-as 100
address-family ipv4 labeled-unicast
route-policy pass-all in
route-policy pass-all out
!
!
neighbor 172.16.5.31
remote-as 300
address-family ipv4 labeled-unicast
route-policy pass-all in
route-policy pass-all out
!
!
vrf cust45
rd 1:45
address-family ipv4 unicast
network 10.3.0.22/32
redistribute connected
!
!
!
mpls ldp
igp sync delay on-session-up 10
mldp
logging notifications
address-family ipv4
!
!
address-family ipv4
label
local
advertise
explicit-null
!
!
!
!
!
multicast-routing
address-family ipv4
interface Loopback0
enable
!
interface Loopback1
enable
!
interface GigabitEthernet0/0/0/2
enable
!
nsf
mdt source Loopback0
accounting per-prefix
mdt mldp in-band-signaling ipv4
!
vrf cust45
address-family ipv4
mdt source Loopback0
interface all enable
mdt mldp in-band-signaling ipv4
!
!
!
router pim
address-family ipv4
rpf topology route-policy mldp1
rp-address 10.1.0.31
ssm range ssm1
!
vrf cust45
address-family ipv4
rpf topology route-policy mldp1
interface Loopback2
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router15">CE46 router</h3>
<div class="cli">
hostname CE46
!
boot-start-marker
boot-end-marker
!
!
enable secret 5 $1$goBG$2y0HMrqusdY.4sLifMyBr0
!
no aaa new-model
!
!
!
!
!
!
!
!
!
no ip domain lookup
!
!
!
ipv6 unicast-routing
!
!
!
!
!
!
!
subscriber templating
!
!
!
!
!
!
!
multilink bundle-name authenticated
!
!
!
!
!
crypto pki trustpoint TP-self-signed-1763681913
enrollment selfsigned
subject-name cn=IOS-Self-Signed-Certificate-1763681913
revocation-check none
rsakeypair TP-self-signed-1763681913
!
!
crypto pki certificate chain TP-self-signed-1763681913
certificate self-signed 01 nvram:IOS-Self-Sig#1.cer
!
!
!
!
!
!
!
!
license udi pid CSR1000V sn 9V3SFQ9AE9S
diagnostic bootup level minimal
!
spanning-tree extend system-id
!
!
username cisco privilege 15 secret 5 $1$zAa3$NJMe88qwwHfRJGYsX2XPI/
!
redundancy
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
interface Loopback0
ip address 10.0.0.46 255.255.255.255
!
interface GigabitEthernet1
ip address 10.255.0.119 255.255.0.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet2
ip address 192.168.8.46 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet2.10
encapsulation dot1Q 10
ip address 10.4.4.46 255.255.255.0
!
router bgp 46
bgp log-neighbor-changes
neighbor 192.168.8.24 remote-as 200
!
address-family ipv4
network 10.0.0.46 mask 255.255.255.255
neighbor 192.168.8.24 activate
exit-address-family
!
address-family ipv6
neighbor 192.168.8.24 activate
exit-address-family
!
threat-visibility
!
virtual-service csr_mgmt
!
ip forward-protocol nd
no ip http server
ip http authentication local
no ip http secure-server
!
ip ssh server algorithm encryption aes128-ctr aes192-ctr aes256-ctr
ip ssh client algorithm encryption aes128-ctr aes192-ctr aes256-ctr
!
!
!
!
!
control-plane
!
!
!
!
!
!
!
!
!
!
line con 0
privilege level 15
password cisco
logging synchronous
stopbits 1
line vty 0 4
exec-timeout 720 0
password cisco
login local
transport input telnet ssh
transport output telnet ssh
!
!
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router16">PE24 router</h3>
<div class="cli">
hostname PE24
!
boot-start-marker
boot-end-marker
!
!
enable secret 5 $1$qUU2$89IH02TAjagBClSJZ/nPF1
!
no aaa new-model
!
ip vrf cust46
rd 1:46
route-target export 1:46
route-target import 1:46
route-target import 1:45
!
!
!
!
!
!
!
!
!
no ip domain lookup
!
!
!
!
!
!
!
!
!
!
subscriber templating
!
!
!
!
!
mpls ldp discovery targeted-hello accept
!
!
multilink bundle-name authenticated
!
!
!
!
!
crypto pki trustpoint TP-self-signed-3076180949
enrollment selfsigned
subject-name cn=IOS-Self-Signed-Certificate-3076180949
revocation-check none
rsakeypair TP-self-signed-3076180949
!
!
crypto pki certificate chain TP-self-signed-3076180949
certificate self-signed 01 nvram:IOS-Self-Sig#1.cer
!
!
!
!
!
!
!
!
license udi pid CSR1000V sn 9R4IDYWT1U3
diagnostic bootup level minimal
!
spanning-tree extend system-id
!
!
username cisco privilege 15 secret 5 $1$K1TZ$asY1nMxKr.wSReoW4QPVa0
!
redundancy
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
interface Loopback0
ip address 10.0.0.24 255.255.255.255
mpls ldp discovery transport-address 10.1.0.24
!
interface Loopback1
ip address 10.1.0.24 255.255.255.255
mpls ldp discovery transport-address interface
!
interface GigabitEthernet1
ip address 10.255.0.129 255.255.0.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet2
ip address 192.168.5.24 255.255.255.0
negotiation auto
mpls ldp discovery transport-address interface
no mop enabled
no mop sysid
!
interface GigabitEthernet3
ip address 192.168.4.24 255.255.255.0
negotiation auto
mpls ldp discovery transport-address interface
no mop enabled
no mop sysid
!
interface GigabitEthernet4
ip address 192.168.2.24 255.255.255.0
negotiation auto
mpls ldp discovery transport-address interface
no mop enabled
no mop sysid
!
interface GigabitEthernet5
ip address 192.168.6.24 255.255.255.0
negotiation auto
mpls ldp discovery transport-address interface
no mop enabled
no mop sysid
!
interface GigabitEthernet6
ip vrf forwarding cust46
ip address 192.168.8.24 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet6.10
encapsulation dot1Q 10
xconnect 10.1.0.15 44 encapsulation mpls
!
router ospf 1
network 10.0.0.0 0.0.0.255 area 0
network 192.168.0.0 0.0.255.255 area 0
mpls ldp autoconfig area 0
!
router bgp 200
bgp router-id 10.0.0.21
bgp log-neighbor-changes
no bgp default ipv4-unicast
neighbor 10.0.0.25 remote-as 200
neighbor 10.0.0.25 update-source Loopback0
!
address-family ipv4
network 10.1.0.24 mask 255.255.255.255
neighbor 10.0.0.25 activate
neighbor 10.0.0.25 send-label
exit-address-family
!
address-family vpnv4
neighbor 10.0.0.25 activate
neighbor 10.0.0.25 send-community extended
neighbor 10.0.0.25 route-reflector-client
exit-address-family
!
address-family ipv4 vrf cust46
neighbor 192.168.8.46 remote-as 46
neighbor 192.168.8.46 activate
exit-address-family
!
threat-visibility
!
virtual-service csr_mgmt
!
ip forward-protocol nd
no ip http server
ip http authentication local
no ip http secure-server
!
ip ssh server algorithm encryption aes128-ctr aes192-ctr aes256-ctr
ip ssh client algorithm encryption aes128-ctr aes192-ctr aes256-ctr
!
!
!
mpls ldp router-id Loopback1 force
!
!
control-plane
!
!
!
!
!
!
!
!
!
!
line con 0
privilege level 15
password cisco
logging synchronous
stopbits 1
line vty 0 4
exec-timeout 720 0
password cisco
login local
transport input telnet ssh
transport output telnet ssh
!
!
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router17">PE15 router</h3>
<div class="cli">
hostname PE15
!
boot-start-marker
boot-end-marker
!
!
enable secret 5 $1$7QEQ$efTmdd7RLnvq5oNP.afZa1
!
no aaa new-model
!
ip vrf cust43
rd 1:43
route-target export 1:43
route-target import 1:43
!
ip vrf cust44
rd 1:44
route-target export 1:44
route-target import 1:44
route-target import 1:100
!
!
!
!
!
!
!
!
!
no ip domain lookup
!
!
!
!
!
!
!
!
!
!
subscriber templating
!
!
!
!
!
mpls traffic-eng tunnels
mpls traffic-eng signalling interpret explicit-null verbatim
mpls ldp discovery targeted-hello accept
!
!
multilink bundle-name authenticated
!
!
!
!
!
crypto pki trustpoint TP-self-signed-1042190476
enrollment selfsigned
subject-name cn=IOS-Self-Signed-Certificate-1042190476
revocation-check none
rsakeypair TP-self-signed-1042190476
!
!
crypto pki certificate chain TP-self-signed-1042190476
certificate self-signed 01 nvram:IOS-Self-Sig#1.cer
!
!
!
!
!
!
!
!
license udi pid CSR1000V sn 9XFCY56QNNT
diagnostic bootup level minimal
!
spanning-tree extend system-id
!
!
username cisco privilege 15 secret 5 $1$iE6L$6LKjtnv/3f/1mzq60bcCG0
!
redundancy
!
!
!
!
!
!
pseudowire-class c44
encapsulation mpls
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
interface Loopback0
ip address 10.0.0.15 255.255.255.255
ip router isis AS100
mpls ldp discovery transport-address 10.1.0.15
!
interface Loopback1
ip address 10.1.0.15 255.255.255.255
!
interface GigabitEthernet1
ip address 10.255.0.124 255.255.0.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet2
ip address 10.1.7.15 255.255.255.0
ip router isis AS100
negotiation auto
mpls traffic-eng tunnels
mpls ldp discovery transport-address interface
no mop enabled
no mop sysid
isis network point-to-point
ip rsvp bandwidth 1000000
!
interface GigabitEthernet3
ip address 10.1.6.15 255.255.255.0
ip router isis AS100
negotiation auto
mpls traffic-eng tunnels
mpls ldp discovery transport-address interface
no mop enabled
no mop sysid
isis network point-to-point
ip rsvp bandwidth 1000000
!
interface GigabitEthernet4
ip vrf forwarding cust43
ip address 10.3.43.15 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet5
ip vrf forwarding cust44
ip address 10.2.44.15 255.255.255.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet5.10
encapsulation dot1Q 10
xconnect 10.1.0.24 44 encapsulation mpls
!
interface GigabitEthernet6
ip address 172.16.1.15 255.255.255.0
negotiation auto
mpls bgp forwarding
no mop enabled
no mop sysid
!
router isis AS100
net 10.0000.0000.0015.00
is-type level-2-only
router-id Loopback0
metric-style wide
mpls traffic-eng router-id Loopback0
mpls traffic-eng level-2
mpls ldp autoconfig
!
router bgp 100
bgp router-id 10.0.0.15
bgp log-neighbor-changes
no bgp default ipv4-unicast
neighbor 10.0.0.17 remote-as 100
neighbor 10.0.0.17 update-source Loopback0
neighbor 172.16.1.21 remote-as 200
!
address-family ipv4
network 10.1.0.15 mask 255.255.255.255
neighbor 10.0.0.17 activate
neighbor 10.0.0.17 send-label
exit-address-family
!
address-family vpnv4
neighbor 10.0.0.17 activate
neighbor 10.0.0.17 send-community extended
neighbor 10.0.0.17 route-reflector-client
neighbor 10.0.0.17 next-hop-self
neighbor 172.16.1.21 activate
neighbor 172.16.1.21 send-community extended
neighbor 172.16.1.21 next-hop-self
exit-address-family
!
address-family ipv4 vrf cust43
neighbor 10.3.43.43 remote-as 43
neighbor 10.3.43.43 activate
exit-address-family
!
address-family ipv4 vrf cust44
neighbor 10.2.44.44 remote-as 44
neighbor 10.2.44.44 activate
exit-address-family
!
threat-visibility
!
virtual-service csr_mgmt
!
ip forward-protocol nd
no ip http server
ip http authentication local
no ip http secure-server
!
ip ssh server algorithm encryption aes128-ctr aes192-ctr aes256-ctr
ip ssh client algorithm encryption aes128-ctr aes192-ctr aes256-ctr
!
!
!
mpls ldp router-id Loopback1 force
!
!
control-plane
!
!
!
!
!
!
!
!
!
!
line con 0
privilege level 15
password cisco
logging synchronous
stopbits 1
line vty 0 4
exec-timeout 720 0
password cisco
login local
transport input telnet ssh
transport output telnet ssh
line vty 5 90
exec-timeout 720 0
password cisco
login local
transport input telnet ssh
transport output telnet ssh
!
!
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router18">PE16 router</h3>
<div class="cli">
hostname PE16
ipv4 access-list as300-in
10 deny tcp any eq bgp any
20 permit ipv4 any any
!
interface Loopback0
ipv4 address 10.0.0.16 255.255.255.255
!
interface MgmtEth0/0/CPU0/0
shutdown
!
interface GigabitEthernet0/0/0/0
ipv4 address 10.1.8.16 255.255.255.0
!
interface GigabitEthernet0/0/0/1
ipv4 address 10.1.4.16 255.255.255.0
!
interface GigabitEthernet0/0/0/2
ipv4 address 10.1.7.16 255.255.255.0
!
interface GigabitEthernet0/0/0/3
ipv4 address 172.16.3.16 255.255.255.0
ipv4 access-group as300-in ingress
!
interface GigabitEthernet0/0/0/4
ipv4 address 172.16.4.16 255.255.255.0
ipv4 access-group as300-in ingress
!
interface GigabitEthernet0/0/0/5
ipv4 address 172.16.2.16 255.255.255.0
!
route-policy pass-all
pass
end-policy
!
router isis AS100
is-type level-2-only
net 10.0000.0000.0016.00
address-family ipv4 unicast
metric-style wide
mpls traffic-eng level-2-only
mpls traffic-eng router-id Loopback0
mpls ldp auto-config
!
address-family ipv6 unicast
metric-style wide
!
interface Loopback0
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
interface GigabitEthernet0/0/0/0
point-to-point
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
interface GigabitEthernet0/0/0/1
point-to-point
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
interface GigabitEthernet0/0/0/2
point-to-point
address-family ipv4 unicast
!
address-family ipv6 unicast
!
!
!
router bgp 100
bgp router-id 10.0.0.16
address-family ipv4 unicast
network 172.16.2.0/24
network 172.16.3.0/24
network 172.16.4.0/24
allocate-label all
!
address-family vpnv4 unicast
!
address-family vpnv6 unicast
!
neighbor 10.0.0.17
remote-as 100
update-source Loopback0
address-family ipv4 labeled-unicast
next-hop-self
!
address-family vpnv4 unicast
!
!
neighbor 172.16.3.22
remote-as 200
address-family ipv4 labeled-unicast
route-policy pass-all in
route-policy pass-all out
!
!
neighbor 172.16.4.31
remote-as 300
address-family ipv4 labeled-unicast
route-policy pass-all in
route-policy pass-all out
!
!
!
rsvp
interface GigabitEthernet0/0/0/0
bandwidth 1000000
!
interface GigabitEthernet0/0/0/1
bandwidth 1000000
!
interface GigabitEthernet0/0/0/2
bandwidth 1000000
!
!
mpls traffic-eng
interface GigabitEthernet0/0/0/0
!
interface GigabitEthernet0/0/0/1
!
interface GigabitEthernet0/0/0/2
!
!
mpls ldp
igp sync delay on-session-up 10
address-family ipv4
label
local
allocate for host-routes
advertise
explicit-null
!
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>
<h3 has-toc-entry id="router19">P14 router</h3>
<div class="cli">
hostname P14
!
boot-start-marker
boot-end-marker
!
!
enable secret 5 $1$M11k$j9c99ZvFaE.LMXZeWv47D0
!
no aaa new-model
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
subscriber templating
!
!
!
!
!
mpls traffic-eng tunnels
!
!
multilink bundle-name authenticated
!
!
!
!
!
crypto pki trustpoint TP-self-signed-1457262380
enrollment selfsigned
subject-name cn=IOS-Self-Signed-Certificate-1457262380
revocation-check none
rsakeypair TP-self-signed-1457262380
!
!
crypto pki certificate chain TP-self-signed-1457262380
certificate self-signed 01 nvram:IOS-Self-Sig#1.cer
!
!
!
!
!
!
!
!
license udi pid CSR1000V sn 9S0EQ77KFVI
diagnostic bootup level minimal
!
spanning-tree extend system-id
!
!
username cisco privilege 15 secret 5 $1$L/XR$sW0LFA.iwv6Ekdmaq.vSd/
!
redundancy
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
interface Loopback0
ip address 10.0.0.14 255.255.255.255
ip router isis AS100
!
interface GigabitEthernet1
ip address 10.255.0.121 255.255.0.0
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet2
ip address 10.1.3.14 255.255.255.0
ip router isis AS100
negotiation auto
mpls traffic-eng tunnels
no mop enabled
no mop sysid
isis network point-to-point
ip rsvp bandwidth 1000000
!
interface GigabitEthernet3
ip address 10.1.9.14 255.255.255.0
ip router isis AS100
negotiation auto
mpls traffic-eng tunnels
no mop enabled
no mop sysid
isis network point-to-point
ip rsvp bandwidth 1000000
!
interface GigabitEthernet4
ip address 10.1.2.14 255.255.255.0
ip router isis AS100
negotiation auto
mpls traffic-eng tunnels
no mop enabled
no mop sysid
isis network point-to-point
ip rsvp bandwidth 1000000
!
interface GigabitEthernet5
ip address 10.1.8.14 255.255.255.0
ip router isis AS100
shutdown
negotiation auto
mpls traffic-eng tunnels
no mop enabled
no mop sysid
isis network point-to-point
ip rsvp bandwidth 1000000
!
interface GigabitEthernet6
no ip address
shutdown
negotiation auto
no mop enabled
no mop sysid
!
interface GigabitEthernet7
ip address 10.1.11.14 255.255.255.0
ip router isis AS100
negotiation auto
no mop enabled
no mop sysid
isis network point-to-point
!
router isis AS100
net 10.0000.0000.0014.00
is-type level-2-only
router-id Loopback0
metric-style wide
mpls traffic-eng router-id Loopback0
mpls traffic-eng level-2
mpls ldp autoconfig
!
threat-visibility
!
virtual-service csr_mgmt
!
ip forward-protocol nd
no ip http server
ip http authentication local
no ip http secure-server
!
ip ssh server algorithm encryption aes128-ctr aes192-ctr aes256-ctr
ip ssh client algorithm encryption aes128-ctr aes192-ctr aes256-ctr
!
!
!
!
!
control-plane
!
!
!
!
!
!
!
!
!
!
line con 0
privilege level 15
password cisco
logging synchronous
stopbits 1
line vty 0 4
exec-timeout 720 0
password cisco
login local
transport input telnet ssh
!
!
!
!
!
!
end<br>
<a href="#config_top">Top &#x21e7;</a>
</div>